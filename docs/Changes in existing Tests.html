<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<title>Changes in existing Tests</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-US>

<div class=WordSection1>

<p class=MsoNormal><b><span style='font-size:14.0pt;line-height:115%'>Changes
in existing Tests / Test Framework.</span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>package com.thoughtworks.webanalyticsautomation;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>/**</p>

<p class=MsoNormal> * Created by: Anand Bagmar</p>

<p class=MsoNormal> * Email: anandb@thoughtworks.com, abagmar@gmail.com</p>

<p class=MsoNormal> * Date: Dec 29, 2010</p>

<p class=MsoNormal> * Time: 9:34:02 AM</p>

<p class=MsoNormal> */</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='background:aqua'>import
com.thoughtworks.webanalyticsautomation.scriptrunner.SeleniumScriptRunner;</span></p>

<p class=MsoNormal><span style='background:aqua'>import
com.thoughtworks.webanalyticsautomation.utils.BROWSER;</span></p>

<p class=MsoNormal><span style='background:aqua'>import
org.apache.log4j.Logger;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>import
com.thoughtworks.webanalyticsautomation.utils.SeleniumScriptRunnerHelper;</p>

<p class=MsoNormal>import org.testng.annotations.AfterMethod;</p>

<p class=MsoNormal>import org.testng.annotations.Test;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>import static
com.thoughtworks.selenium.grid.tools.ThreadSafeSeleniumSessionStorage.session;</p>

<p class=MsoNormal>import static org.testng.Assert.assertEquals;</p>

<p class=MsoNormal>import static org.testng.Assert.assertNotNull;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>@Test (singleThreaded = true)</p>

<p class=MsoNormal>public class EngineWithSeleniumTest {</p>

<p class=MsoNormal>    private SeleniumScriptRunnerHelper
seleniumScriptRunnerHelper;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    private Logger logger = Logger.getLogger(getClass());</p>

<p class=MsoNormal>    <span style='background:aqua'>private Engine engine;</span></p>

<p class=MsoNormal>    <span style='background:aqua'>private String webAnalyticTool
= &quot;omniture&quot;;</span></p>

<p class=MsoNormal><span style='background:aqua'>    private String
inputFileType = &quot;xml&quot;;</span></p>

<p class=MsoNormal><span style='background:aqua'>    private boolean
keepLoadedFileInMemory = true;</span></p>

<p class=MsoNormal><span style='background:aqua'>    private String
log4jPropertiesAbsoluteFilePath = System.getProperty(&quot;user.dir&quot;) +
&quot;\\lib\\WAAT\\resources\\log4j.properties&quot;;</span></p>

<p class=MsoNormal>    <span style='background:aqua'>private String
inputDataFileName = System.getProperty(&quot;user.dir&quot;) +
&quot;\\lib\\WAAT\\sampledata\\OmnitureTestData.xml&quot;;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='background:aqua'>/* </span></p>

<p class=MsoNormal><span style='background:aqua'>*             If using TestNG,
override the @AfterMethod annotation</span></p>

<p class=MsoNormal><span style='background:aqua'>*             If using JUnit,
override the @After annotation</span></p>

<p class=MsoNormal><span style='background:aqua'>*             and add the
following line in it:</span></p>

<p class=MsoNormal><span style='background:aqua'>*                                    
engine.disableWebAnalyticsTesting();</span></p>

<p class=MsoNormal><span style='background:aqua'>*             See the example
shown below</span></p>

<p class=MsoNormal><span style='background:aqua'>*/</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>    <span style='background:yellow'>@AfterMethod()</span></b></p>

<p class=MsoNormal>    public void tearDown() throws Exception {</p>

<p class=MsoNormal>        <span style='background:aqua'>engine.disableWebAnalyticsTesting();</span></p>

<p class=MsoNormal>        seleniumScriptRunnerHelper.stopSeleniumDriver();</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    @Test</p>

<p class=MsoNormal>    public void
captureAndVerifyDataReportedToWebAnalytics_Selenium_IE() throws Exception {</p>

<p class=MsoNormal>        <span style='background:aqua'>String actionName =
&quot;OpenUpcomingPage&quot;;</span></p>

<p class=MsoNormal><span style='background:aqua'>        engine =
Controller.getInstance(webAnalyticTool, inputFileType, keepLoadedFileInMemory,
log4jPropertiesAbsoluteFilePath);</span></p>

<p class=MsoNormal><span style='background:aqua'>       
engine.enableWebAnalyticsTesting();</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='background:yellow'>/*</span></p>

<p class=MsoNormal><span style='background:yellow'>*             Existing test
/ test framework code</span></p>

<p class=MsoNormal><span style='background:yellow'>*/</span></p>

<p class=MsoNormal>        session().open(SeleniumScriptRunnerHelper.BASE_URL +
&quot;/upcoming&quot;);</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>        <span style='background:aqua'>Result
verificationResult = engine.verifyWebAnalyticsData (inputDataFileName,
actionName, new SeleniumScriptRunner(session()));</span></p>

<p class=MsoNormal><span style='background:aqua'>/*</span></p>

<p class=MsoNormal><span style='background:aqua'>*             Sample
validations</span></p>

<p class=MsoNormal><span style='background:aqua'>*/</span></p>

<p class=MsoNormal>        <span style='background:yellow'>assertNotNull(verificationResult.getVerificationStatus(),
&quot;Verification status should NOT be NULL&quot;);</span></p>

<p class=MsoNormal><span style='background:yellow'>        assertNotNull(verificationResult.getListOfErrors(),
&quot;Failure details should NOT be NULL&quot;);</span></p>

<p class=MsoNormal><span style='background:yellow'>       
logVerificationErrors(verificationResult);</span></p>

<p class=MsoNormal><span style='background:yellow'>       
assertEquals(verificationResult.getVerificationStatus(), Status.PASS,
&quot;Verification status should be PASS&quot;);</span></p>

<p class=MsoNormal><span style='background:yellow'>        assertEquals(verificationResult.getListOfErrors().size(),
0, &quot;Failure details should be empty&quot;);</span></p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
